<div class="student-management-container">
  <div class="student-header">
    <h2>All Students</h2>
    <input
      type="text"
      class="search-input"
      placeholder="Search by student name..."
      [(ngModel)]="searchTerm"
      (input)="onSearchChange()"
    />
  </div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Email</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let student of filteredStudents; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ student.name }}</td>
        <td>{{ student.email }}</td>
        <td class="actions">
          <button class="btn view-btn" (click)="onViewEnrollments(student)">View Enrollments</button>
          <button class="btn delete-btn" (click)="onDeleteStudent(student.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="filteredStudents.length === 0" class="empty-placeholder">
    No students found. Try adjusting your search.
  </div>

  <!-- Student Enrollments Modal -->
  <div *ngIf="isModalVisible" class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeModal()">Ã—</button>
      <h3>Enrollments for {{ selectedStudent?.name }}</h3>

      <div class="table-scroll-container" *ngIf="selectedStudentEnrollments.length > 0; else noEnrollments">
        <table class="enrollments-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Course Title</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let enrollment of selectedStudentEnrollments; let j = index">
              <td>{{ j + 1 }}</td>
              <td>{{ enrollment.course?.title || 'Course Title Missing' }}</td>
              <td>{{ enrollment.status || 'N/A' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <ng-template #noEnrollments>
        <p>No enrollments found for this student.</p>
      </ng-template>
    </div>
  </div>

  <!-- Common Modal Component -->
  <app-common-modal></app-common-modal>
</div>
